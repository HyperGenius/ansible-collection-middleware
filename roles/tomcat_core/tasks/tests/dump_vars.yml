---
# testinfra用に変数データをJSONファイルに出力
- name: Dump role variables to JSON for Testinfra
  ansible.builtin.copy:
    content: |
      {{
        {
          'tomcat_core_version': tomcat_core_version,
          'tomcat_core_java_version': tomcat_core_java_version,
          'tomcat_core_install_dir': tomcat_core_install_dir,
          'tomcat_core_service_name': tomcat_core_service_name,
          'tomcat_core_http_port': tomcat_core_http_port,
          'tomcat_core_shutdown_port': tomcat_core_shutdown_port,
          'tomcat_core_ajp_port': tomcat_core_ajp_port,
          'tomcat_core_user': tomcat_core_user,
          'tomcat_core_group': tomcat_core_group,
        } | to_nice_json
      }}
    dest: /tmp/ansible_vars.json
    mode: '0644'
